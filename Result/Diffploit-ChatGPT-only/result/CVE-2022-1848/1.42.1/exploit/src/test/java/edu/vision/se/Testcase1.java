package edu.vision.se;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import org.junit.Test;

import com.erudika.para.core.User;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.Path;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;

public class Testcase1 {
    @Test
    public void testPasswordConstraint() throws Exception {
        User u = new User();
        u.setName("test");
        u.setEmail("ab@cd.com");
        u.setIdentifier("ab@cd.com");
        
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        Validator validator = factory.getValidator();
        
        assertTrue(validator.validate(u).isEmpty());
        
        String password = new String(Files.readAllBytes(Paths.get("/PoCAdaptation/exploit/file/CVE-2022-1848.txt")));
        u.setPassword(password.trim()); 
        
        assertFalse(validator.validate(u).isEmpty());
    }
}
