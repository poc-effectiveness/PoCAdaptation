package edu.vision.se;

import com.fasterxml.jackson.dataformat.xml.XmlFactory;
import com.fasterxml.jackson.dataformat.xml.XmlMapper;
import java.util.Map;
import static org.junit.Assert.fail;
import org.junit.Test;

public class Testcase1 {

    @Test(timeout = 5000)
    public void testDTDAttempt() throws Exception {
        XmlFactory factory = new XmlFactory();
        // In 2.7.7, we need to use the builder to configure DTD support
        XmlMapper mapper = new XmlMapper(factory);
        mapper.enableDefaultTyping();
        String XML = "<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE foo [ <!ELEMENT foo ANY ><!ENTITY xxe SYSTEM \"file:///etc/passwd\" >]>\n"
                + "<foo>&xxe;</foo>";

        try {
            /* Map<String, String> info = */ mapper.readValue(XML, Map.class);
            fail("Should have thrown an exception for DTD processing");
        } catch (Exception e) {
            // Expected to pass
        }
    }
}
