package edu.vision.se;

import java.util.List;

import static org.assertj.core.api.Assertions.assertThat;
import org.junit.Test;
import org.springframework.security.ConfigAttribute;
import org.springframework.security.ConfigAttributeDefinition;
import org.springframework.security.ConfigAttributeEditor;
import org.springframework.security.vote.AuthenticatedVoter;
import org.springframework.security.providers.anonymous.AnonymousAuthenticationToken;
import org.springframework.security.Authentication;
import org.springframework.security.GrantedAuthority;
import org.springframework.security.GrantedAuthorityImpl;

public class Testcase1 {

    @Test
    public void testAnonymousWorks() {
        AuthenticatedVoter voter = new AuthenticatedVoter();
        ConfigAttributeEditor editor = new ConfigAttributeEditor();
        editor.setAsText(AuthenticatedVoter.IS_AUTHENTICATED_ANONYMOUSLY);
        ConfigAttributeDefinition attribute = (ConfigAttributeDefinition) editor.getValue();
        validateReturnValue(voter.vote(null, null, attribute));
    }

    public void validateReturnValue(int result) {
         assertThat(result).isEqualTo(AuthenticatedVoter.ACCESS_DENIED);
    }

    public Authentication createAnonymous() {
        return new AnonymousAuthenticationToken("ignored", "ignored", new GrantedAuthority[] {new GrantedAuthorityImpl("ignored")});
    }
}
